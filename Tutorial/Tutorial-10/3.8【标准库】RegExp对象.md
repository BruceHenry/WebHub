### 3.8 RegExp对象
[教程地址： 3.8 RegExp对象](http://javascript.ruanyifeng.com/stdlib/regexp.html)

---
### 目录
```
1. 概述
2. 正则对象的属性和方法
   2.1 属性
   2.2 test()
   2.3 exec()
3. 字符串对象的方法
   3.1 String.prototype.match()
   3.2 String.prototype.search()
   3.3 String.prototype.replace()
   3.4 String.prototype.split()
4. 匹配规则
   4.1 字面量字符和元字符
   4.2 转义符
   4.3 特殊字符
   4.4 字符类
   4.5 预定义模式
   4.6 重复类
   4.7 量词符
   4.8 贪婪模式
   4.9 修饰符
   4.10 组匹配
5. 参考链接
```

---
### 1. 概述
- 新建正则表达式有两种方法。一种是使用字面量，以斜杠表示开始和结束
- 另一种是使用RegExp构造函数
- RegExp构造函数还可以接受第二个参数，表示修饰符
- 正则对象生成以后，有两种使用方式
   *   正则对象的方法：将字符串作为参数，比如`regex.test(string)`。
   *   字符串对象的方法：将正则对象作为参数，比如`string.match(regex)`
   
```
var regex = /xyz/;
var regex = new RegExp('xyz');

var regex = new RegExp('xyz', "i");
// 等价于
var regex = /xyz/i;
```

---
### 2. 正则对象的属性和方法

#### 2.1 属性
- 正则对象的属性分成两类。

- 一类是修饰符相关，返回一个布尔值，表示对应的修饰符是否设置
   *   **ignoreCase**：返回一个布尔值，表示是否设置了i修饰符，该属性只读。
   *   **global**：返回一个布尔值，表示是否设置了g修饰符，该属性只读。
   *   **multiline**：返回一个布尔值，表示是否设置了m修饰符，该属性只读。

- 另一类是与修饰符无关的属性，主要是下面两个
   *   `lastIndex`：返回下一次开始搜索的位置。该属性可读写，但是只在设置了`g`修饰符时有意义。
   *   `source`：返回正则表达式的字符串形式（不包括反斜杠），该属性只读
   
#### 2.2 test()
- 正则对象的`test`方法返回一个布尔值，表示当前模式是否能匹配参数字符串

```js
var r = /x/g;
var s = '_x_x';

r.lastIndex // 0
r.test(s) // true

r.lastIndex // 2
r.test(s) // true

r.lastIndex // 4
r.test(s) // false
```

#### 2.3 exec()
- 正则对象的`exec`方法，可以返回匹配结果。如果发现匹配，就返回一个数组，成员是每一个匹配成功的子字符串，否则返回`null`
- 如果正则表示式包含圆括号（即含有“组匹配”），则返回的数组会包括多个成员。第一个成员是整个匹配成功的结果，后面的成员就是圆括号对应的匹配成功的组。也就是说，第二个成员对应第一个括号，第三个成员对应第二个括号，以此类推
- `exec`方法的返回数组还包含以下两个属性
  *   `input`：整个原字符串
  *   `index`：整个模式匹配成功的开始位置（从0开始计数）
  
- 如果正则表达式加上`g`修饰符，则可以使用多次`exec`方法，下一次搜索的位置从上一次匹配成功结束的位置开始
- 正则对象的`lastIndex`属性不仅可读，还可写。一旦手动设置了`lastIndex`的值，就会从指定位置开始匹配。但是，这只在设置了`g`修饰符的情况下，才会有效
- 如果正则对象是一个空字符串，则`exec`方法会匹配成功，但返回的也是空字符串

```js
var s = '_xy_xy';
var r = /_((x)y)/;

r.exec(s); // ["_xy", "xy", "x"]
```

---
### 3. 字符串对象的方法
- 字符串对象的方法之中，有4种与正则对象有关
   *   `match()`：返回一个数组，成员是所有匹配的子字符串。
   *   `search()`：按照给定的正则表达式进行搜索，返回一个整数，表示匹配开始的位置。
   *   `replace()`：按照给定的正则表达式进行替换，返回替换后的字符串。
   *   `split()`：按照给定规则进行字符串分割，返回一个数组，包含分割后的各个成员。
   
#### 3.1 String.prototype.match()
- 如果正则表达式带有`g`修饰符，则`match`方法与正则对象的`exec`方法行为不同，会一次性返回所有匹配成功的结果
- 设置正则表达式的`lastIndex`属性，对`match`方法无效，匹配总是从字符串的第一个字符开始

```
var s = '_x_x';
var r1 = /x/;
var r2 = /y/;

s.match(r1) // ["x"]
s.match(r2) // null
```

#### 3.2 String.prototype.search()
- 字符串对象的`search`方法，返回第一个满足条件的匹配结果在整个字符串中的位置。如果没有任何匹配，则返回`-1`
- `search`方法会忽略`g`修饰符, `lastIndex`也无效

```
'_x_x'.search(/x/)
// 1
```

#### 3.3 String.prototype.replace()
- 字符串对象的`replace`方法可以替换匹配的值。它接受两个参数，第一个是搜索模式，第二个是替换的内容
- 搜索模式如果不加g修饰符，就替换第一个匹配成功的值，否则替换所有匹配成功的值
- replace方法的第二个参数可以使用美元符号$，用来指代所替换的内容
   *   `$&` 指代匹配的子字符串。
   *   `$`` 指代匹配结果前面的文本。
   *   `$'` 指代匹配结果后面的文本。
   *   `$n` 指代匹配成功的第`n`组内容，`n`是从1开始的自然数。
   *   `$$` 指代美元符号`$`

- replace方法的第二个参数还可以是一个函数，将每一个匹配内容替换为函数返回值
- 作为replace方法第二个参数的替换函数，可以接受多个参数。第一个参数是捕捉到的内容，第二个参数是捕捉到的组匹配

```
'aaa'.replace('a', 'b') // "baa"
'aaa'.replace(/a/, 'b') // "baa"
'aaa'.replace(/a/g, 'b') // "bbb"

'hello world'.replace(/(\w+)\s(\w+)/, '$2 $1')
// "world hello"

'3 and 5'.replace(/[0-9]+/g, function(match){
  return 2 * match;
})
// "6 and 10"
```

#### 3.4 String.prototype.split()
- 字符串对象的`split`方法按照正则规则分割字符串，返回一个由分割后的各个部分组成的数组
- 该方法接受两个参数，第一个参数是分隔规则，第二个参数是返回数组的最大成员数

---
### 4. 匹配规则

#### 4.1 字面量字符和元字符
- 大部分字符在正则表达式中，就是字面的含义，比如`/a/`匹配`a`，`/b/`匹配`b`。如果在正则表达式之中，某个字符只表示它字面的含义（就像前面的`a`和`b`），那么它们就叫做“字面量字符”
- 点字符（`.`）匹配除回车（`\r`）、换行(`\n`) 、行分隔符（`\u2028`）和段分隔符（`\u2029`）以外的所有字符
- 位置字符用来提示字符所处的位置，主要有两个字符
  *   `^` 表示字符串的开始位置
  *   `$` 表示字符串的结束位置
- 竖线符号（`|`）在正则表达式中表示“或关系”（OR），即`cat|dog`表示匹配`cat`或`dog`

#### 4.2 转义符
- 正则表达式中那些有特殊含义的字符，如果要匹配它们本身，就需要在它们前面要加上反斜杠

#### 4.3 特殊字符
- `\cX` 表示`Ctrl-[X]`，其中的`X`是A-Z之中任一个英文字母，用来匹配控制字符。
- `[\b]` 匹配退格键(U+0008)，不要与`\b`混淆。
- `\n` 匹配换行键。
- `\r` 匹配回车键。
- `\t` 匹配制表符tab（U+0009）。
- `\v` 匹配垂直制表符（U+000B）。
- `\f` 匹配换页符（U+000C）。
- `\0` 匹配null字符（U+0000）。
- `\xhh` 匹配一个以两位十六进制数（`\x00`-`\xFF`）表示的字符。
- `\uhhhh` 匹配一个以四位十六进制数（`\u0000`-`\uFFFF`）表示的unicode字符

#### 4.4  字符类
- 字符类（class）表示有一系列字符可供选择，只要匹配其中一个就可以了。所有可供选择的字符都放在方括号内，比如`[xyz]` 表示`x`、`y`、`z`之中任选一个匹配
- 有两个字符在字符类中有特殊含义
   - 如果方括号内的第一个字符是`[^]`，则表示除了字符类之中的字符，其他字符都可以匹配
   - 某些情况下，对于连续序列的字符，连字符（`-`）用来提供简写形式，表示字符的连续范围。比如，`[abc]`可以写成`[a-c]`，`[0123456789]`可以写成`[0-9]`，同理`[A-Z]`表示26个大写字母
   

#### 4.5 预定义模式
- `\d` 匹配0-9之间的任一数字，相当于`[0-9]`。
- `\D` 匹配所有0-9以外的字符，相当于`[^0-9]`。
- `\w` 匹配任意的字母、数字和下划线，相当于`[A-Za-z0-9_]`。
- `\W` 除所有字母、数字和下划线以外的字符，相当于`[^A-Za-z0-9_]`。
- `\s` 匹配空格（包括制表符、空格符、断行符等），相等于`[\t\r\n\v\f]`。
- `\S` 匹配非空格的字符，相当于`[^\t\r\n\v\f]`。
- `\b` 匹配词的边界。
- `\B` 匹配非词边界，即在词的内部

#### 4.6 重复类
- 模式的精确匹配次数，使用大括号（`{}`）表示。`{n}`表示恰好重复n次，`{n,}`表示至少重复n次，`{n,m}`表示重复不少于n次，不多于m次

#### 4.7 量词符
- 量词符用来设定某个模式出现的次数。
   *   `?` 问号表示某个模式出现0次或1次，等同于`{0, 1}`。
   *   `*` 星号表示某个模式出现0次或多次，等同于`{0,}`。
   *   `+` 加号表示某个模式出现1次或多次，等同于`{1,}`
   
#### 4.8 贪婪模式
- 上一小节的三个量词符，默认情况下都是最大可能匹配，即匹配直到下一个字符不满足匹配规则为止。这被称为贪婪模式
- 如果想将贪婪模式改为非贪婪模式，可以在量词符后面加一个问号
- 除了非贪婪模式的加号，还有非贪婪模式的星号（`*`）和加号（`+`）
   *   `*?`：表示某个模式出现0次或多次，匹配时采用非贪婪模式。
   *   `+?`：表示某个模式出现1次或多次，匹配时采用非贪婪模式

#### 4.9 修饰符
- 修饰符（modifier）表示模式的附加规则，放在正则模式的最尾部
- 修饰符可以单个使用，也可以多个一起使用
  - **g修饰符**:表示全局匹配（global），加上它以后，正则对象将匹配全部符合条件的结果，主要用于搜索和替换
  - **i修饰符**: 加上`i`修饰符以后表示忽略大小写（ignorecase）
  - **m修饰符**: `m`修饰符表示多行模式（multiline），会修改`^`和`$`的行为。默认情况下（即不加`m`修饰符时），`^`和`$`匹配字符串的开始处和结尾处，加上`m`修饰符以后，`^`和`$`还会匹配行首和行尾，即`^`和`$`会识别换行符（`\n`）


#### 4.10 组匹配
- 正则表达式的括号表示分组匹配，括号中的模式可以用来匹配分组的内容
